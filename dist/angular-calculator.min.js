/**
 * An AngularJS module for create a dynamic calculator
 * @version 0.1.0
 * @link https://github.com/maximepvrt/angular-calculator
 */
!function(){"use strict";angular.module("angular-calculator",[])}(),function(){"use strict";angular.module("angular-calculator").filter("paramsFilter",[function(){return function(a,n){if(void 0!==a)return a.filter(function(a){if(!a.rules)return!0;var u=!1;return angular.forEach(a.rules,function(a){u===!1&&(u=!0,angular.forEach(a,function(a,e){n[e]!=a&&(u=!1)}))}),u},{})}}])}(),function(){"use strict";angular.module("angular-calculator").filter("round",[function(){return function(a,n){return"undefined"==typeof n||0===+n?Math.round(a):(a=+a,n=+n,isNaN(a)||"number"!=typeof n||n%1!==0?NaN:(a=a.toString().split("e"),a=Math.round(+(a[0]+"e"+(a[1]?+a[1]+n:n))),a=a.toString().split("e"),+(a[0]+"e"+(a[1]?+a[1]-n:-n))))}}])}(),function(){"use strict";angular.module("angular-calculator").factory("$calculator",["$rootScope","$filter",function(a,n){function u(){l.params=l.params.map(function(a){if(a.dynamicUnit){var u=null,e=null;angular.forEach(l.units[a.dynamicUnit],function(n){n.value&&a.dynamicUnitValue&&a.dynamicUnitValue===n.id&&(u=n),l.config[a.dynamicUnit]===n.id&&(e=n)}),null===u&&(u={value:1}),e.value||(e.value=1),a.dynamicUnitValue=l.config[a.dynamicUnit],a.unit=e.sign,a.max=n("round")(a.max/u.value*e.value,2),a.min=n("round")(a.min/u.value*e.value,2),a.step=n("round")(a.step/u.value*e.value,2),a.value=n("round")(a.value/u.value*e.value,2)}return a})}function e(){l.filteredParams=n("paramsFilter")(l.params,l.config)}function r(){l.values={},angular.forEach(l.filteredParams,function(a){void 0!==l.values[a.name]&&l.values[a.name].id===a.id||(l.values[a.name]=a.value)})}function t(){e(),u(),i()}function i(){r(),f(c),o(c)}var l={config:{},units:{},params:[],filteredParams:[],values:{}},f=function(){},o=function(){},c={setParamValue:function(a,n){l.params=l.params.map(function(u){return a===u.id&&(u.value=n),u}),l.filteredParams=l.filteredParams.map(function(u){return a===u.id&&(u.value=n),u})},setParam:function(a,n){n.value||(n.value=n.defaultValue);var u=!1;l.params=l.params.map(function(e){return a===e.id?(u=!0,n):e}),l.filteredParams=l.filteredParams.map(function(e){return a===e.id?(u=!0,n):e})},param:function(a){return angular.copy(l.params.filter(function(n){return a===n.id})[0])},setParams:function(a){l.params=a.map(function(a){return a.value||(a.value=a.defaultValue),a})},params:function(){return angular.copy(l.params)},values:function(){return angular.copy(l.values)},resetValues:function(){l.params=l.params.map(function(a){return a.value=a.defaultValue,a}),l.filteredParams=l.filteredParams.map(function(a){return a.value=a.defaultValue,a})},valuesToDefaultValues:function(){l.params=l.params.map(function(a){return a.defaultValue=a.value,a}),l.filteredParams=l.filteredParams.map(function(a){return a.defaultValue=a.value,a})},paramsValues:function(){return l.params.reduce(function(a,n){return a[n.id]=n.value,a},{})},value:function(a){return angular.copy(l.values[a])},setValue:function(a,n){l.values[a]=n},filteredParams:function(){return angular.copy(l.filteredParams)},addUnit:function(a,n){l.units[a]=n;var u=n.filter(function(a){return void 0===a.value||null===a.value||1===a.value})[0];l.config[a]=u.id},currentUnit:function(a){return l.units[a].filter(function(n){return n.id===l.config[a]})[0]},config:function(){return angular.copy(l.config)},setConfig:function(a){angular.forEach(a,function(a,n){l.config[n]=a})}};return a.ok=f,{data:l,extraRules:function(a){f=a},calculator:function(a){o=a},param:c.param,params:c.params,filteredParams:c.filteredParams,setParams:function(a){c.setParams(a),t()},setParam:function(a,n){c.setParam(a,n),i()},setParamValue:function(a,n){c.setParamValue(a,n),i()},config:c.config,addUnit:c.addUnit,values:c.values,value:c.value,currentUnit:c.currentUnit,setConfig:function(a){c.setConfig(a),t()},resetValues:function(){c.resetValues(),i()},valuesToDefaultValues:function(){c.valuesToDefaultValues(),i()},setValue:function(a,n){c.setValue(a,n),o(c)},paramsValues:c.paramsValues}}])}();